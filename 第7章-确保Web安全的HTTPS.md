## 前言

> 在http中有可能存在信息窃听和身份伪装等安全问题，使用https通信机制可以有效的防止这些问题。

## 7.1 http的缺点

1. 通信使用明文（不加密），可能会被窃听。
2. 不验证通信方的身份，因此有可能遭遇伪装
3. 无法证明报文的完整性，所以有可能已经被篡改。

**需要说明的是这些问题不仅仅会出现在http协议上，其他没有加密的协议也会有这类问题**

### 7.1.1 通信使用明文可能会被窃听

> 由于http本身不具备加密的功能，所以也无法做到对通信整体进行加密。也就是说http使用明文进行传输

**TCP/IP是可能被窃听的网络**

为什么通信不加密是一个缺点，原因是按照TCP/IP协议族的工作机制，通信内容在所有通信线路上都有可能会被窃听。

`所谓互联网，就是由能够联通到全世界的网络所组成的，无论世界的哪个角落的服务器在何客户端通信时，在此通信线路上的某些网络设备、光缆、计算机等都不可能是个人的私有物，所以不排除某个环节会遭到恶意窥视行为。`

即使已经加密处理的通信也会被窥视到通信内容，这点和未加密的通信是一致的。只是说通信如果通过加密，就有可能让人无法破解报文的含义。但加密处理后的报文信息还是会被看到的。

**加密处理防止被窃听**

> 防止窃听保护信息的几种机制中，最为普及的就是加密技术。

**1. 通信的加密**

> 一种方式就是将通信加密，http协议中没有通信机制，但是可以和SSL（Source Socket Layer安全套接层）或TLS（Transport Layer Security安全层传输协议）的组合使用，加密http的通信内容。

用SSL建立通信安全通信线路后，就可以在这条线路上进行http通信了，与ssl组合使用的http被称为https。

**2. 内容的加密**

还有一种将参与通信的内容本身进行加密的方式，由于http本身没有加密机制，那就对http协议传输的内容本身进行加密。即对http报文里所含的内容进行加密。

在这种情况下，客户端需要对http报文进行加密后再发送。

![](http://odssgnnpf.bkt.clouddn.com/jiami@2x.png)

为了做到有效的内容加密，要求客户端和服务端同时具备加密和解密的机制。主要应用在Web服务器中，有一点必须引起注意，由于该方式不同于SSL或TLS将整个通信线路进行加密，所以内容仍然有被篡改的风险。

### 7.1.2 不验证通信方的身份就有可能遭遇伪装。

> http协议中请求和响应不会对通信方进行确认，也就是说存在**“服务器是否就是发送请求URI真正指定的主机，返回的响应是否真的返回到实际提出请求的客户端”**等类似问题。
(但也仅限与发送端的IP地址和端口号没有被Web服务器设定限制访问的情况下)

![](http://odssgnnpf.bkt.clouddn.com/QQ20180217-161504@2x.png)


不确认通信双方，会存在以下各种隐患

* 无法确定请求发送至目标的web服务器是否是按真实意图返回相应的那台服务器，有可能是已伪装的web服务器。

* 无法确定响应返回到的客户端是否是按真实意图接收响应的那个客户端，有可能是已伪装的客户端。

* 无法确定正在通信的对方是否具备访问权限，因为某些web服务器上保存着重要的信息，指向发给特定用户通信的权限。

* 无法判定请求是来自何方，出自谁手

* 即使是无意义的请求也会照单全收。无法阻止海量请求下的Dos攻击


## 查明对手的证书

> SSL不仅提供加密处理，而且还使用了一种被称为证书的手段，可用于确定通信双方。

**证书是由值得信任的第三方机构颁发，用以证明服务器和客户端是实际存在的，另外伪造证书对技术角度来说是一件异常困难的事，所以只要能够确认通信方（服务器或者客户端）持有证书，即可判断通信方的真实意图**

![](http://odssgnnpf.bkt.clouddn.com/QQ20180217-162526@2x.png)


